

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Window &mdash; Vega-Lite Docs 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Projection" href="../projection.html" />
    <link rel="prev" title="Time Unit" href="timeunit.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Vega-Lite Docs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../task_decription/mdtext.html">The problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../task_decription/retext.html">rst format tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../task_decription/retext.html#plain-test-of-layerchart-docstring-elements">Plain test of LayerChart docstring elements</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../vega-lite-toc.html">Vega-lite</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#specification-description">Specification description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#view-specification">View Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#data">Data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../vega-lite-toc.html#transform">Transform</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="transform.html">Transformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="aggregate.html">Aggregation</a></li>
<li class="toctree-l3"><a class="reference internal" href="bin.html">Binning</a></li>
<li class="toctree-l3"><a class="reference internal" href="calculate.html">Calculate Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="filter.html">Filter Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="lookup.html">Lookup Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="timeunit.html">Time Unit</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Window</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#documentation-overview">Documentation Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#window-field-definition">Window Field Definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#window-transform-definition">Window Transform Definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ops">Window Only Operation Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#projection">Projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#marks">Marks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#encoding">Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#view-composition">View Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#selection">Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#config">Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#parameter-types">Parameter Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#tooltip">Tooltip</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../vega-lite-toc.html">Vega-lite</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#specification-description">Specification description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#view-specification">View Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#data">Data</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../vega-lite-toc.html#transform">Transform</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="transform.html">Transformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="aggregate.html">Aggregation</a></li>
<li class="toctree-l3"><a class="reference internal" href="bin.html">Binning</a></li>
<li class="toctree-l3"><a class="reference internal" href="calculate.html">Calculate Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="filter.html">Filter Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="lookup.html">Lookup Transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="timeunit.html">Time Unit</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Window</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#documentation-overview">Documentation Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#window-field-definition">Window Field Definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#window-transform-definition">Window Transform Definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ops">Window Only Operation Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#projection">Projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#marks">Marks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#encoding">Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#view-composition">View Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#selection">Selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#config">Config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#parameter-types">Parameter Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vega-lite-toc.html#tooltip">Tooltip</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vega-Lite Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../vega-lite-toc.html">Vega-lite</a> &raquo;</li>
        
      <li>Window</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/docs/transform/window.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="window">
<h1>Window<a class="headerlink" href="#window" title="Permalink to this headline">¶</a></h1>
<p>The window transform performs calculations over sorted groups of data objects. These calculations including ranking, lead/lag analysis, and aggregates such as running sums and averages. Calculated values are written back to the input data stream.</p>
<div class="section" id="documentation-overview">
<h2>Documentation Overview<a class="headerlink" href="#documentation-overview" title="Permalink to this headline">¶</a></h2>
<p></p>
<ul class="simple">
<li>TOC
</li>
</ul>
</div>
<div class="section" id="window-field-definition">
<h2>Window Field Definition<a class="headerlink" href="#window-field-definition" title="Permalink to this headline">¶</a></h2>
<p></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span>// A View Specification
{
  ...
  &quot;transform&quot;: [
    {
      // Window Transform
      &quot;window&quot;: [{
          &quot;op&quot;: ...,
          &quot;field&quot;: ...,
          &quot;param&quot;: ...
          &quot;as&quot;: ...
      }],
      &quot;sort&quot;: [
        {&quot;field&quot;: ..., &quot;order&quot;: ...}
      ],
      &quot;ignorePeers&quot;: ...,
      &quot;groupby&quot;: [
        &quot;...&quot;
      ],
      &quot;frame&quot;: [...,...]
    }
     ...
  ],
  ...
}
</pre></div>
</div>
</div>
<div class="section" id="window-transform-definition">
<h2>Window Transform Definition<a class="headerlink" href="#window-transform-definition" title="Permalink to this headline">¶</a></h2>
<p><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>liqid template: like &quot;.. altair-object-table::&quot; 
{% include table.html props=&quot;window,frame,ignorePeers,groupby,sort&quot; source=&quot;WindowTransform&quot; %}
</pre></div>
</div>
</p>
<p></p>
<div class="section" id="field-def">
<h3>Window Transform Field Definition<a class="headerlink" href="#field-def" title="Permalink to this headline">¶</a></h3>
<p><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>liqid template: like &quot;.. altair-object-table::&quot; 
{% include table.html props=&quot;op,param,field,as&quot; source=&quot;WindowFieldDef&quot; %}
</pre></div>
</div>
</p>
<p></p>
</div>
<div class="section" id="sort-field-def">
<h3>Sort Field Definition<a class="headerlink" href="#sort-field-def" title="Permalink to this headline">¶</a></h3>
<p><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>liqid template: like &quot;.. altair-object-table::&quot; 
{% include table.html props=&quot;field,order&quot; source=&quot;SortField&quot; %}
</pre></div>
</div>
</p>
<p></p>
</div>
</div>
<div class="section" id="ops">
<h2>Window Only Operation Reference<a class="headerlink" href="#ops" title="Permalink to this headline">¶</a></h2>
<p>The valid operations include all <a class="reference external" href="ops">aggregate operations</a> plus the following window operations.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>table_block stub
| Operation    | Parameter | Description  |
| :----------- | :-------: | :------------|
| row_number   | _None_    | Assigns each data object a consecutive row number, starting from 1.|
| rank         | _None_    | Assigns a rank order value to each data object in a window, starting from 1. Peer values are assigned the same rank. Subsequent rank scores incorporate the number of prior values. For example, if the first two values tie for rank 1, the third value is assigned rank 3.|
| dense_rank   | _None_    | Assigns dense rank order values to each data object in a window, starting from 1. Peer values are assigned the same rank. Subsequent rank scores do not incorporate the number of prior values. For example, if the first two values tie for rank 1, the third value is assigned rank 2.|
| percent_rank | _None_    | Assigns a percentage rank order value to each data object in a window. The percent is calculated as _(rank - 1) / (group_size - 1)_. |
| cume_dist    | _None_    | Assigns a cumulative distribution value between 0 and 1 to each data object in a window.|
| ntile        | Number | Assigns a quantile (e.g., percentile) value to each data object in a window. Accepts an integer parameter indicating the number of buckets to use (e.g., 100 for percentiles, 5 for quintiles).|
| lag          | Number | Assigns a value from the data object that precedes the current object by a specified number of positions. If no such object exists, assigns `null`. Accepts an offset parameter (default `1`) that indicates the number of positions. This operation must have a corresponding entry in the _fields_ parameter array.|
| lead         | Number | Assigns a value from the data object that follows the current object by a specified number of positions. If no such object exists, assigns `null`. Accepts an offset parameter (default `1`) that indicates the number of positions. This operation must have a corresponding entry in the _fields_ parameter array.|
| first_value  | _None_    | Assigns a value from the first data object in the current sliding window frame. This operation must have a corresponding entry in the _fields_ parameter array.|
| last_value   | _None_    | Assigns a value from the last data object in the current sliding window frame. This operation must have a corresponding entry in the _fields_ parameter array.|
| nth_value    | Number | Assigns a value from the nth data object in the current sliding window frame. If no such object exists, assigns `null`. Requires a non-negative integer parameter that indicates the offset from the start of the window frame. This operation must have a corresponding entry in the _fields_ parameter array.|
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Below are some common use cases for the window transform.</p>
<div class="section" id="cumulative-frequency-distribution">
<h3>Cumulative Frequency Distribution<a class="headerlink" href="#cumulative-frequency-distribution" title="Permalink to this headline">¶</a></h3>
<p>Here we use the window transform with <code class="docutils literal notranslate"><span class="pre">frame:</span> <span class="pre">[null,</span> <span class="pre">0]</span></code> to accumulate count in a cumulative frequency distribution plot.</p>
<p><strong>See also:</strong> <a class="reference external" href="layer_cumulative_histogram">layered histogram and cumulative histogram</a></p>
</div>
<div class="section" id="percent-of-total">
<h3>Percent of Total<a class="headerlink" href="#percent-of-total" title="Permalink to this headline">¶</a></h3>
<p>Here we use the window transform to derive the global sum so that we can calculate percentage.</p>
</div>
<div class="section" id="difference-from-mean">
<h3>Difference from Mean<a class="headerlink" href="#difference-from-mean" title="Permalink to this headline">¶</a></h3>
<p>One example is to show the “exemplar” movies from a movie collection. Here “exemplar” is defined by having a score of 2.5 points higher than the global average.</p>
<p>Another example is to show the “exemplar” movies based on the release year average. Here “exemplar” is defined by having a score 2.5 points higher than the annual average for its release year (instead of the global average).</p>
<p>Rather than filtering the above two examples we can also calculate a residual by deriving the mean using the window transform first.</p>
</div>
<div class="section" id="rank-chart">
<h3>Rank Chart<a class="headerlink" href="#rank-chart" title="Permalink to this headline">¶</a></h3>
<p>We can also use <code class="docutils literal notranslate"><span class="pre">rank</span></code> operator to calculate ranks over time.</p>
</div>
<div class="section" id="top-k">
<h3>Top K<a class="headerlink" href="#top-k" title="Permalink to this headline">¶</a></h3>
<p>Here we use window transform to derive the total number of students along with the rank of the current student to determine the top K students and display their score.</p>
</div>
<div class="section" id="cumulative-running-average">
<h3>Cumulative Running Average<a class="headerlink" href="#cumulative-running-average" title="Permalink to this headline">¶</a></h3>
<p>Here we use window transform to visualize how the average MPG for vehicles have changed over the years.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../projection.html" class="btn btn-neutral float-right" title="Projection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="timeunit.html" class="btn btn-neutral" title="Time Unit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, UW Interactive Data Lab, ported by Ilia Timofeev.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/vlexample.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>